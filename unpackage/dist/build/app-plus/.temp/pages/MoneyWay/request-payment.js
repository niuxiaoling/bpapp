require("../../common/manifest.js");
require("../../common/vendor.js");
global.webpackJsonp([11],{62:function(e,t,n){"use strict";var o=s(n(0)),a=s(n(63));function s(e){return e&&e.__esModule?e:{default:e}}new o.default(a.default).$mount()},63:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(65),a=n.n(o),s=n(69);var i=function(e){n(64)},r=n(1)(a.a,s.a,i,null,null);t.default=r.exports},64:function(e,t){},65:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var o,a=n(66),s=(o=a)&&o.__esModule?o:{default:o};t.default={data:function(){return{title:"request-payment",loading:!1,providerList:[]}},onLoad:function(){var t=this;e.getProvider({service:"payment",success:function(e){console.log("payment success",e),t.providerList=e.provider.map(function(e){switch(e){case"alipay":return{name:"支付宝",id:e,loading:!1};case"wxpay":return{name:"微信",id:e,loading:!1}}})},fail:function(e){console.log("获取登录通道失败：",e)}})},methods:{weixinPay:function(){var t=this;console.log("发起支付"),this.loading=!0,e.login({success:function(n){console.log("login success",n),e.request({url:"https://unidemo.dcloud.net.cn/payment/wx/mp?code="+n.code+"&amount=0.01",success:function(n){if(console.log("pay request success",n),200===n.statusCode)if(0===n.data.ret){console.log("得到接口prepay_id",n.data.payment);var o=n.data.payment;e.requestPayment({timeStamp:o.timeStamp,nonceStr:o.nonceStr,package:o.package,signType:"MD5",paySign:o.paySign,success:function(t){e.showToast({title:"感谢您的赞助!"})},fail:function(t){e.showModal({content:"支付失败,原因为: "+t.errMsg,showCancel:!1})},complete:function(){t.loading=!1}})}else e.showModal({content:n.data.desc,showCancel:!1});else e.showModal({content:"支付失败，请重试！",showCancel:!1})},fail:function(n){console.log("fail",n),t.loading=!1,e.showModal({content:"支付失败,原因为: "+n.errMsg,showCancel:!1})}})},fail:function(n){console.log("fail",n),t.loading=!1,e.showModal({content:"支付失败,原因为: "+n.errMsg,showCancel:!1})}})},requestPayment:function(t,n){var o,a=this;return(o=s.default.mark(function o(){var i;return s.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return a.providerList[n].loading=!0,o.next=3,a.getOrderInfo(t.id);case 3:if(i=o.sent,console.log("得到订单信息",i),200===i.statusCode){o.next=9;break}return console.log("获得订单信息失败",i),e.showModal({content:"获得订单信息失败",showCancel:!1}),o.abrupt("return");case 9:e.requestPayment({provider:t.id,orderInfo:i.data,success:function(t){console.log("success",t),e.showToast({title:"感谢您的赞助!"})},fail:function(t){console.log("fail",t),e.showModal({content:"支付失败,原因为: "+t.errMsg,showCancel:!1})},complete:function(){a.providerList[n].loading=!1}});case 10:case"end":return o.stop()}},o,a)}),function(){var e=o.apply(this,arguments);return new Promise(function(t,n){return function o(a,s){try{var i=e[a](s),r=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(r).then(function(e){o("next",e)},function(e){o("throw",e)});t(r)}("next")})})()},getOrderInfo:function(t){var n="https://demo.dcloud.net.cn/payment/?payid="+t+"&appid="+plus.runtime.appid+"&total=0.01";return new Promise(function(t){e.request({url:n,success:function(e){t(e)},fail:function(e){t(e)}})})},getInfo:function(){var t={payInfo:{totalFee:"0.01",body:"0.01元"},requestType:"aLiPay"},n={controllerRequestType:"payControllerService",jsonString:JSON.stringify(t)};e.request({url:this.websiteUrl,method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:n,success:function(t){"0000"==t.data.errorCode||e.showToast({icon:"none",title:t.data.errorMessage})},fail:function(e){console.log(e)}})}}}}).call(t,n(2).default)},69:function(e,t,n){"use strict";var o={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",[n("page-head",{attrs:{title:e.title,mpcomid:"2Wy-0"}}),n("view",{staticClass:"page-body"},[n("view",{staticClass:"page-section"},[n("view",[e._v("支付金额")]),e._m(0),n("view",{staticClass:"desc"},[e._v("实际应用中可自定义金额")]),n("view",{staticClass:"btn-area"},e._l(e.providerList,function(t,o){return n("button",{key:o,attrs:{loading:t.loading,eventid:"TmD-0-"+o},on:{tap:function(n){e.requestPayment(t,o)}}},[e._v(e._s(t.name)+"支付")])})),n("view",{attrs:{eventid:"x8m-1"},on:{tap:e.getInfo}},[e._v("获取支付信息")])])])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("view",{staticClass:"price"},[t("text",{staticClass:"rmbLogo"},[this._v("￥")]),this._v("0.01")])}]};t.a=o}},[62]);